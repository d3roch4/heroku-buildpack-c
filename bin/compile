#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

set -e
set -o pipefail

BUILD_DIR=$1
CACHE_DIR=$2

echo "instaling cmake"
if [ -f /app/cmake-3.1.0-Linux-x86_64/bin/cmake ]; then
  wget https://github.com/Munett/cmake-binary/raw/master/cmake.tar.gz -O cmake.tgz
  tar xzvf cmake.tgz -C /app
fi

cd $BUILD_DIR
mkdir build
cd build
/app/cmake-3.1.0-Linux-x86_64/bin/cmake ..
echo "-----> Configuring CMake"

# make
echo "-----> Compiling with Make"
make
